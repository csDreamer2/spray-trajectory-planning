# Unity 3D视图集成测试指南

## 🎯 测试目标

验证Qt应用程序与Unity 3D引擎的集成功能，确保点云数据能够正确加载和显示。

## 📋 测试前准备

### 1. 环境要求
- Windows 10/11 操作系统
- Qt 6.10.1 + MSVC 2022
- Unity 2022.3 LTS (可选，用于独立测试)
- 可用的点云测试文件

### 2. 测试文件
推荐使用以下测试文件：
- `test_data/sample_cube.ply` - 小型测试文件
- `test_data/pointclouds/凝汽下半未分割.ply` - 中型工件
- `test_data/pointclouds/凝汽下半（大）未分割.ply` - 大型工件

## 🧪 测试步骤

### 测试1: 应用程序启动
1. 启动 `SprayTrajectoryPlanning.exe`
2. 验证主窗口正常显示
3. 检查Unity视图区域是否显示占位内容
4. 确认状态栏显示"Unity服务器已启动，端口: 12346"

**预期结果**: ✅ 应用程序正常启动，界面布局正确

### 测试2: Unity连接状态
1. 观察Unity视图区域的连接状态
2. 点击"测试连接"按钮
3. 查看状态栏的连接信息

**预期结果**: 
- 🟡 显示"等待Unity连接..."（如果Unity未启动）
- 🟢 显示"Unity已连接"（如果Unity已启动）

### 测试3: 点云文件加载
1. 点击菜单 `文件 -> 导入工件`
2. 选择测试点云文件（建议先用sample_cube.ply）
3. 观察进度对话框显示
4. 等待加载完成

**预期结果**: 
- ✅ 进度对话框正常显示
- ✅ 可以点击"取消"按钮中断加载
- ✅ 加载完成后显示统计信息

### 测试4: Unity数据传输
1. 完成点云加载后
2. 观察Unity视图区域状态变化
3. 检查状态面板的日志信息

**预期结果**:
- ✅ Unity视图显示"工件已成功加载"
- ✅ 状态面板记录传输的点数
- ✅ 无错误信息

### 测试5: 性能测试
1. 加载大型点云文件（>100K点）
2. 观察加载时间和UI响应性
3. 检查内存使用情况

**预期结果**:
- ✅ 加载时间 < 5秒
- ✅ UI始终保持响应
- ✅ 内存使用合理

### 测试6: 错误处理
1. 尝试加载无效文件
2. 在加载过程中取消操作
3. 断开网络连接测试

**预期结果**:
- ✅ 显示友好的错误信息
- ✅ 取消操作正常工作
- ✅ 连接错误有适当提示

## 📊 性能基准

### 加载时间基准
| 文件大小 | 点数 | 预期加载时间 | 传输点数 |
|----------|------|--------------|----------|
| < 1MB | < 10K | < 1秒 | 全部 |
| 1-10MB | 10K-100K | 1-3秒 | 15K-20K |
| 10-50MB | 100K-500K | 3-5秒 | 20K-25K |
| > 50MB | > 500K | < 8秒 | 25K |

### UI响应性要求
- 进度对话框必须实时更新
- 取消按钮必须立即响应
- 主窗口不能出现"未响应"状态

## 🔧 故障排除

### 常见问题

#### 1. Unity连接失败
**症状**: 显示"Unity连接超时"
**解决方案**:
- 检查防火墙设置，允许端口12346
- 确认没有其他程序占用该端口
- 重启应用程序

#### 2. 点云加载失败
**症状**: 显示"点云解析失败"
**解决方案**:
- 检查文件格式是否支持（PLY/PCD/OBJ）
- 确认文件没有损坏
- 检查文件路径中是否包含特殊字符

#### 3. 加载速度慢
**症状**: 加载时间超过预期
**解决方案**:
- 检查文件大小，大文件需要更长时间
- 确认系统内存充足
- 关闭其他占用资源的程序

#### 4. UI卡顿
**症状**: 界面无响应
**解决方案**:
- 这不应该发生，如果出现请报告bug
- 尝试重启应用程序
- 检查系统资源使用情况

## 📝 测试报告模板

```
测试日期: ____
测试人员: ____
系统环境: ____

测试结果:
□ 应用程序启动 - 通过/失败
□ Unity连接状态 - 通过/失败  
□ 点云文件加载 - 通过/失败
□ Unity数据传输 - 通过/失败
□ 性能测试 - 通过/失败
□ 错误处理 - 通过/失败

发现的问题:
1. ________________
2. ________________

建议改进:
1. ________________
2. ________________
```

## 🚀 高级测试

### 压力测试
1. 连续加载多个大文件
2. 快速切换不同点云文件
3. 长时间运行稳定性测试

### 兼容性测试
1. 测试不同格式的点云文件
2. 测试包含中文路径的文件
3. 测试损坏或格式错误的文件

### 网络测试
1. 模拟网络延迟
2. 测试连接中断和恢复
3. 测试并发连接

## ✅ 验收标准

系统通过测试的标准：
- [x] 所有基本功能测试通过
- [x] 性能指标达到基准要求
- [x] 错误处理机制完善
- [x] 用户体验流畅
- [x] 无严重bug或崩溃

## 📞 技术支持

如果在测试过程中遇到问题，请：
1. 记录详细的错误信息和操作步骤
2. 截图保存错误界面
3. 检查应用程序日志文件
4. 联系开发团队获取支持

---

**注意**: 本测试指南基于任务6.3的实现，确保Unity 3D视图集成功能的质量和稳定性。